# Development Guide

## Project Structure

```
├── api/
│   └── index.js              # Vercel serverless function
├── contracts/
│   └── Counter.sol           # Smart contract
├── public/
│   ├── js/
│   │   ├── config.js         # Generated configuration (DO NOT EDIT)
│   │   ├── wallet.js         # Wallet management module
│   │   └── app.js           # Main application logic
│   ├── index.html           # Main counter page (modular)
│   └── leaderboard.html     # Leaderboard page
├── scripts/
│   └── build-frontend.js    # Builds frontend configuration
├── subgraph/                # GraphQL subgraph for indexing
├── app.js                   # Local development server
├── config.example.js        # Configuration template
└── vercel.json             # Vercel deployment config
```

## Development Workflow

### 1. Setup
```bash
npm install
cd subgraph && npm install && cd ..
```

### 2. Configuration
Copy `config.example.js` to `config.js` and update:
```bash
cp config.example.js config.js
# Edit config.js with your contract address and settings
```

### 3. Development
```bash
npm run dev
# This will:
# - Generate frontend config from backend config
# - Start development server with hot reload
```

### 4. Build for Production
```bash
npm run build:prod
```

## Configuration Management

### Backend Config (`config.js`)
- Contains contract address, network, API URLs
- Used by both `app.js` and `api/index.js`
- Environment variables override config values

### Frontend Config (`public/js/config.js`)
- **AUTO-GENERATED** - Do not edit manually
- Generated by `scripts/build-frontend.js`
- Contains contract address, ABI, and network info

### Build Process
1. `npm run build` reads `config.js`
2. Generates `public/js/config.js` with frontend config
3. Frontend modules load config from `window.CONFIG`

## File Purposes

### Main Files
- **`app.js`**: Local development server
- **`api/index.js`**: Vercel serverless function (same logic as app.js)
- **`public/index.html`**: Main UI (now modular with separate JS files)

### JavaScript Modules
- **`config.js`**: Configuration (generated)
- **`wallet.js`**: WalletManager class for Web3 operations
- **`app.js`**: CounterApp class for UI management

### Development vs Production
- **Local**: Uses `config.js` file
- **Vercel**: Uses environment variables with config fallbacks

## Best Practices

1. **Always run `npm run build` before testing**
2. **Update `config.js`, not `public/js/config.js`**
3. **Test both local and Vercel environments**
4. **Keep modules small and focused**

## Deployment

### Local Development
```bash
npm run dev
```

### Vercel Deployment
```bash
vercel
# Environment variables override config.js values
```

### Environment Variables (Vercel)
- `CONTRACT_ADDRESS`: Your deployed contract
- `SUBGRAPH_URL`: Your subgraph endpoint
- `NETWORK`: Target network name 